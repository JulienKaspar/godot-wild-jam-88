[gd_scene load_steps=30 format=3 uid="uid://cx2qst5txs1af"]

[ext_resource type="Script" uid="uid://cdppyptuftkiw" path="res://Characters/Player/logic/player_movement.gd" id="1_jkj6u"]
[ext_resource type="PackedScene" uid="uid://cyksrihj0achx" path="res://Particles/Player/pfx_falling_indicator.tscn" id="2_6yvek"]
[ext_resource type="Script" uid="uid://b5ewjdm5d53je" path="res://Characters/Player/logic/rigid_bally.gd" id="2_fy1gk"]
[ext_resource type="PackedScene" uid="uid://bhvwgh4ef0sj6" path="res://Particles/Player/pfx_bodyfall.tscn" id="3_on8bp"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_on8bp"]

[sub_resource type="SphereShape3D" id="SphereShape3D_056gf"]
margin = 0.0
radius = 0.25

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_056gf"]

[sub_resource type="SphereMesh" id="SphereMesh_jkj6u"]
radial_segments = 5
rings = 2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_6yvek"]
transparency = 1
albedo_color = Color(0.74509805, 0, 0.7607843, 0.5647059)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_jkj6u"]
material = SubResource("StandardMaterial3D_6yvek")
radius = 0.25
height = 1.8

[sub_resource type="PrismMesh" id="PrismMesh_jkj6u"]
size = Vector3(0.52, 1.215, 0.06)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_t5fyq"]
transparency = 1
albedo_color = Color(1, 0.15294118, 0.7921569, 0.47843137)

[sub_resource type="CylinderMesh" id="CylinderMesh_jkj6u"]
top_radius = 0.2
bottom_radius = 0.2
height = 0.01

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_jkj6u"]
transparency = 1
albedo_color = Color(0, 0, 0, 0.59607846)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_on8bp"]
transparency = 1
albedo_color = Color(1, 0, 0, 0.59607846)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_fy1gk"]
transparency = 1
albedo_color = Color(0, 0.8980392, 0, 0.59607846)

[sub_resource type="CylinderMesh" id="CylinderMesh_6yvek"]
top_radius = 0.2
bottom_radius = 0.2
height = 0.01

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_vokij"]
transparency = 1
albedo_color = Color(0, 0.1882353, 0.9098039, 0.59607846)

[sub_resource type="SphereShape3D" id="SphereShape3D_jkj6u"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_jkj6u"]
radius = 0.25
height = 1.634668

[sub_resource type="CapsuleMesh" id="CapsuleMesh_6yvek"]
radius = 0.25
height = 1.2

[sub_resource type="PrismMesh" id="PrismMesh_6yvek"]
size = Vector3(0.525, 0.505, 0.12)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_fy1gk"]
radius = 0.3
height = 1.0

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_6yvek"]
radius = 0.08203125
height = 0.76420593

[sub_resource type="CapsuleMesh" id="CapsuleMesh_on8bp"]
radius = 0.082
height = 0.764

[sub_resource type="Animation" id="Animation_6yvek"]
length = 0.001

[sub_resource type="Animation" id="Animation_on8bp"]
resource_name = "flasky_drink"

[sub_resource type="Animation" id="Animation_jkj6u"]
resource_name = "roll"
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("UpperBody/BodyAttachPoint:position:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(0, 0),
"points": PackedFloat32Array(0, -0.25, 0, 0.25, 0, 0, -0.16111112, 0, 0, 0),
"times": PackedFloat32Array(0, 1)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("UpperBody/BodyAttachPoint:position:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0, 2, 2, 2, 0),
"points": PackedFloat32Array(-1.164, -0.25, 0, 0.26666668, 0.022952914, -0.46906802, -0.06666666, -0.40532067, 0.019559946, 0.118920766, 0.55490005, -0.03333333, -0.021332681, 0.06762935, 0.043281466, -0.373071, -0.032743838, 0.419108, 0.100000024, -1.2799602, -1.164, -0.16666669, 0.48160535, 0, 0),
"times": PackedFloat32Array(0, 0.33333334, 0.46666667, 0.56666666, 1)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("UpperBody/BodyAttachPoint:position:z")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(0, 0, 2, 2, 0),
"points": PackedFloat32Array(0, -0.25, 0, 0.13985342, 0.13386804, -1.0877154, -0.061111115, 0, 0.10555556, 0, 0.58689904, -0.04922843, -0.37018627, 0.06666666, 0.50131774, -0.010415651, -0.09686451, 0.51142865, 0.06666666, -0.35198903, 0, -0.100000024, -0.021081984, 0, 0),
"times": PackedFloat32Array(0, 0.33333334, 0.53333336, 0.73333335, 1)
}
tracks/3/type = "bezier"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("UpperBody/BodyAttachPoint:rotation:x")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"handle_modes": PackedInt32Array(0, 2, 0),
"points": PackedFloat32Array(0, -0.25, 0, 0.23463735, 0.06491547, 3.9597936, -0.09488855, -1.4691511, 0.19999999, 3.096582, 6.282, -0.19999999, -0.019036293, 0, 0),
"times": PackedFloat32Array(0, 0.53333336, 1)
}
tracks/4/type = "bezier"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("UpperBody/BodyAttachPoint:rotation:y")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"handle_modes": PackedInt32Array(0, 2),
"points": PackedFloat32Array(0, -0.25, 0, 0.25, 0, 0, -0.16666667, 0, 0, 0),
"times": PackedFloat32Array(0, 1)
}
tracks/5/type = "bezier"
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/path = NodePath("UpperBody/BodyAttachPoint:rotation:z")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/keys = {
"handle_modes": PackedInt32Array(0, 2),
"points": PackedFloat32Array(0, -0.25, 0, 0.25, 0, 0, -0.16666667, 0, 0, 0),
"times": PackedFloat32Array(0, 1)
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_on8bp"]
_data = {
&"RESET": SubResource("Animation_6yvek"),
&"flasky_drink": SubResource("Animation_on8bp"),
&"roll": SubResource("Animation_jkj6u")
}

[node name="PlayerController" type="Node3D"]
script = ExtResource("1_jkj6u")

[node name="RigidBally3D" type="RigidBody3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.251, 0)
collision_layer = 2
collision_mask = 189
mass = 50.0
physics_material_override = SubResource("PhysicsMaterial_on8bp")
contact_monitor = true
max_contacts_reported = 10
script = ExtResource("2_fy1gk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="RigidBally3D"]
shape = SubResource("SphereShape3D_056gf")

[node name="helper_ball" type="MeshInstance3D" parent="RigidBally3D"]
transform = Transform3D(0.52, 0, 0, 0, 0.52, 0, 0, 0, 0.52, 0, 0, 0)
material_override = SubResource("StandardMaterial3D_056gf")
mesh = SubResource("SphereMesh_jkj6u")

[node name="upper_body_pivot" type="Node3D" parent="RigidBally3D"]
unique_name_in_owner = true

[node name="helper_Body" type="MeshInstance3D" parent="RigidBally3D/upper_body_pivot"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.7315148, 0)
mesh = SubResource("CapsuleMesh_jkj6u")

[node name="helper_BodyDir" type="MeshInstance3D" parent="RigidBally3D/upper_body_pivot"]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, -1, 0, 1, -4.371139e-08, 0, -0.15997481, 0.047753245)
mesh = SubResource("PrismMesh_jkj6u")
surface_material_override/0 = SubResource("StandardMaterial3D_t5fyq")

[node name="up_aligned" type="Node3D" parent="RigidBally3D"]
unique_name_in_owner = true

[node name="helper_leaning" type="MeshInstance3D" parent="RigidBally3D/up_aligned"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.2206907, 0)
mesh = SubResource("CylinderMesh_jkj6u")
skeleton = NodePath("../../..")
surface_material_override/0 = SubResource("StandardMaterial3D_jkj6u")

[node name="helper_drunk_dir" type="MeshInstance3D" parent="RigidBally3D/up_aligned"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.2206907, 0)
mesh = SubResource("CylinderMesh_jkj6u")
skeleton = NodePath("../../..")
surface_material_override/0 = SubResource("StandardMaterial3D_on8bp")

[node name="helper_player_dir" type="MeshInstance3D" parent="RigidBally3D/up_aligned"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.2206907, 0)
mesh = SubResource("CylinderMesh_jkj6u")
skeleton = NodePath("../../..")
surface_material_override/0 = SubResource("StandardMaterial3D_fy1gk")

[node name="helper_player_facing" type="MeshInstance3D" parent="RigidBally3D/up_aligned"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.2206907, 0.9966068)
mesh = SubResource("CylinderMesh_6yvek")
skeleton = NodePath("../../..")
surface_material_override/0 = SubResource("StandardMaterial3D_vokij")

[node name="RayCastStairs" type="RayCast3D" parent="RigidBally3D"]
collision_mask = 128

[node name="PinJoint3D" type="PinJoint3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.25, 0)
node_a = NodePath("../RigidBally3D")
node_b = NodePath("../NoRotateBall")

[node name="PinJoint3D2" type="PinJoint3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.27, 0)
node_a = NodePath("../NoRotateBall")
node_b = NodePath("../UpperBody")

[node name="NoRotateBall" type="RigidBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.25, 0)
collision_layer = 0
collision_mask = 0
lock_rotation = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="NoRotateBall"]
shape = SubResource("SphereShape3D_jkj6u")

[node name="PfxFallingIndicator" parent="NoRotateBall" instance=ExtResource("2_6yvek")]
emitting = false

[node name="Label3D" type="Label3D" parent="NoRotateBall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.8597615, 0)
visible = false
pixel_size = 0.004
text = "JA"
outline_size = 50

[node name="UpperBody" type="RigidBody3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.164401, 0)
collision_layer = 2
collision_mask = 61

[node name="CollisionShape3D" type="CollisionShape3D" parent="UpperBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.21733397, 0)
shape = SubResource("CapsuleShape3D_jkj6u")

[node name="helper_body_col" type="MeshInstance3D" parent="UpperBody"]
mesh = SubResource("CapsuleMesh_6yvek")

[node name="helper_body_hat" type="MeshInstance3D" parent="UpperBody/helper_body_col"]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, -1, 0, 1, -4.371139e-08, 0, 0.570469, 0.02934675)
mesh = SubResource("PrismMesh_6yvek")

[node name="joint_arm_left" type="ConeTwistJoint3D" parent="UpperBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.1701982, 0.23231983, 0)
node_a = NodePath("..")
node_b = NodePath("../../ArmL")
swing_span = 1.3229595

[node name="joint_arm_right" type="ConeTwistJoint3D" parent="UpperBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.17, 0.232, 0)
node_a = NodePath("..")
node_b = NodePath("../../ArmR")
swing_span = 1.3229595

[node name="joint_leg_left" type="ConeTwistJoint3D" parent="UpperBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.1692875, -0.392967, -0.004346937)
node_a = NodePath("..")
node_b = NodePath("../../LegL")
twist_span = 0.0

[node name="joint_leg_right" type="ConeTwistJoint3D" parent="UpperBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.169, -0.393, -0.004)
node_a = NodePath("..")
node_b = NodePath("../../LegR")
twist_span = 0.0

[node name="BodyAttachPoint" type="Node3D" parent="UpperBody"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.164, 0)

[node name="body_ref_mesh" type="MeshInstance3D" parent="UpperBody/BodyAttachPoint"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.0583978, 0)
visible = false
mesh = SubResource("CapsuleMesh_fy1gk")

[node name="AttachPointFootR" type="Marker3D" parent="UpperBody/BodyAttachPoint"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.16933973, 0.42215487, 0.001949653)

[node name="AttachPointFootL" type="Marker3D" parent="UpperBody/BodyAttachPoint"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.169, 0.422, 0.002)

[node name="PfxBodyfall" parent="UpperBody" instance=ExtResource("3_on8bp")]

[node name="ArmL" type="RigidBody3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(-4.371139e-08, -1, 0, 1, -4.371139e-08, 0, 0, 0, 1, 0.802604, 1.3483973, 2.3841858e-07)
collision_layer = 2
collision_mask = 61

[node name="CollisionShape3D" type="CollisionShape3D" parent="ArmL"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.23290259, 0)
shape = SubResource("CapsuleShape3D_6yvek")

[node name="helper_arm_left" type="MeshInstance3D" parent="ArmL"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.23290259, 0)
mesh = SubResource("CapsuleMesh_on8bp")

[node name="ArmR" type="RigidBody3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(-4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 0, 0, 1, -0.803, 1.348, 0)
collision_layer = 2
collision_mask = 61

[node name="CollisionShape3D" type="CollisionShape3D" parent="ArmR"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.23290259, 0)
shape = SubResource("CapsuleShape3D_6yvek")

[node name="helper_arm_right" type="MeshInstance3D" parent="ArmR"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.23290259, 0)
mesh = SubResource("CapsuleMesh_on8bp")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_on8bp")
}

[node name="TimerRoll" type="Timer" parent="."]
one_shot = true

[node name="TimerStandUp" type="Timer" parent="."]
one_shot = true

[node name="TimerFalling" type="Timer" parent="."]
wait_time = 5.0
one_shot = true

[node name="LegL" type="RigidBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.16108675, 0.015062436, 4.7683716e-07)
collision_layer = 2
collision_mask = 61
mass = 0.3

[node name="CollisionShape3D" type="CollisionShape3D" parent="LegL"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39960164, 0)
shape = SubResource("CapsuleShape3D_6yvek")

[node name="helper_arm_left" type="MeshInstance3D" parent="LegL"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39960164, 0)
mesh = SubResource("CapsuleMesh_on8bp")

[node name="LegR" type="RigidBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.161, 0.015, 0)
collision_layer = 2
collision_mask = 61
mass = 0.3

[node name="CollisionShape3D" type="CollisionShape3D" parent="LegR"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39960164, 0)
shape = SubResource("CapsuleShape3D_6yvek")

[node name="helper_arm_left" type="MeshInstance3D" parent="LegR"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39960164, 0)
mesh = SubResource("CapsuleMesh_on8bp")

[connection signal="timeout" from="TimerRoll" to="." method="_on_timer_roll_timeout"]
[connection signal="timeout" from="TimerStandUp" to="." method="_on_timer_stand_up_timeout"]
[connection signal="timeout" from="TimerFalling" to="." method="_on_timer_falling_timeout"]
